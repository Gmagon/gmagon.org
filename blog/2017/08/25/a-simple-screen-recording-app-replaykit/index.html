<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">

  <title>A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.</title>

  <meta http-equiv="X-UA-Compatible" content="IE=8; IE=9; IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="robots" content="noodp" />
  <meta name="keywords" content="A Simple Screen Recording App-ReplayKit" />
  <meta name="description" content="A Simple Screen Recording App-ReplayKit" />

  <!-- Custom config og:image -->


  <!-- Open Graph -->
<meta name="description" content="A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.">
<meta property="og:type" content="apps">
<meta property="og:title" content="A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.">
<meta property="og:url" content="https://gmagon.com/blog/2017/08/25/a-simple-screen-recording-app-replaykit/index.html">
<meta property="og:site_name" content="A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.">
<meta property="og:description" content="A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://img1.tuicool.com/yayMBzE.png!web">
<meta property="og:image" content="http://img2.tuicool.com/JrI7Rfj.png!web">
<meta property="og:image" content="http://img0.tuicool.com/Zreimi2.png!web">
<meta property="og:image" content="http://img2.tuicool.com/7NRBVvz.png!web">
<meta property="og:image" content="http://img0.tuicool.com/Zf6VBrA.png!web">
<meta property="og:image" content="http://img0.tuicool.com/7VNJj2J.png!web">
<meta property="og:image" content="http://img2.tuicool.com/r6jiAvj.png!web">
<meta property="og:image" content="http://img2.tuicool.com/jiUVZj3.png!web">
<meta property="og:image" content="http://img1.tuicool.com/RbUV7rJ.png!web">
<meta property="og:updated_time" content="2017-08-26T23:21:24.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.">
<meta name="twitter:description" content="A Simple Screen Recording App-ReplayKit - Gmagon Software - handy and professional Mac apps.">
<meta name="twitter:image" content="http://img1.tuicool.com/yayMBzE.png!web">
<meta name="twitter:site" content="gmagonshare">
<meta property="fb:admins" content="432634277117208">
<meat name="twitter:url" content="https://gmagon.com/blog/2017/08/25/a-simple-screen-recording-app-replaykit/index.html">



  <!-- algolia_config -->
  
  
  <!-- Canonical links -->
  <link rel="canonical" href="https://gmagon.com/blog/2017/08/25/a-simple-screen-recording-app-replaykit/index.html">

  <!-- Alternative links -->
  

  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">

  <!-- CSS -->
  <link rel="stylesheet" href="/build/css/navy-8a8ae8dac6.css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/asset/styles/global.css">
  
  <!-- jQuery -->
  <script src="/js/jquery/jquery-3.2.1.min.js"></script>
<script src="/js/jquery/jquery-migrate-1.4.1.min.js"></script>



  <!-- ForPostLayout -->
  
    
    
  
  <!-- endForPostLayout -->

  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Gmagon Software - handy and professional Mac apps.">

  <!-- algolia_search -->
  <script src="/assets/algolia/algoliasearchLite.min.js" async></script>

  <!-- Utils -->
<script src="/js/utils.js"></script>
</head>

<body>
  <div id="container">
    <header id="header">
  <div class="wrapper">
    <div id="header-inner" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Gmagon Software - handy and professional Mac apps.</a>
        <span>gmagon </span>
      </h1>
      <nav id="main-nav">
        <a href="/" class="main-nav-link ">Home</a><a href="/products/" class="main-nav-link ">Products</a><a href="/guide/" class="main-nav-link ">Guide</a><a href="/support/" class="main-nav-link ">Support</a><a href="/blog/" class="main-nav-link ">Blog</a>
        <div id="search-input-wrap">
          <a href="/search/" class="text-decoration-none ">
            <div id="search-input-icon">
              <i class="fa fa-search"></i>
            </div>
          </a>
        </div>
      </nav>
      <div id="lang-select-wrap">
        <label id="lang-select-label"><i class="fa fa-globe"></i><span>English</span></label>
        <select id="lang-select" data-canonical="">
          
            <option value="en" selected>English</option>
          
        </select>
      </div>
      <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a>
    </div>
  </div>  
</header>
<div class="hide-wrap-head-top"></div>
    <div class="class-content-wrap">
  <div class="inner">
    <div class="inner-wrap fill-bunting font-e3">
      <h2 id="banner-title"> A Simple Screen Recording App-ReplayKit </h2>
      <div id="banner-start">
        <a class="btn btn-static-secondary btn-shadow" href="https://gitter.im/Gmagon/support" ttarget="_blank" rel="nofollow me noopener noreferrer" >Need help?</a>
      </div>
    </div>
  </div>
</div>

<div class="class-content-wrap">
  <div class="wrapper">
    <div class="inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
          <div class="hide-wrap-head-top"></div>
<article class="article post" itemscope itemtype="http://schema.org/Article">
  <header class="article-header">
    
      <h1 class="article-title" itemprop="name">A Simple Screen Recording App-ReplayKit</h1>
    
    <a href="/blog/2017/08/25/a-simple-screen-recording-app-replaykit/" class="article-date"><time datetime="2017-08-25T00:00:00.000Z">2017-08-25</time></a>
  </header>
  <div class="article-content" itemprop="articleBody">
    <p>Who doesnâ€™t love playing games on their iPhone? I think that my friends and family would agree that I waste way too much time on my phone playing games. However, games are one of the many things that show off the incredible things an iPhone can do with its crazy power and beautiful display.</p>
<p>Almost everyone who loves playing games on their iPhone loves to brag to their friends how great they are at them. That is why Apple announced<a href="https://developer.apple.com/documentation/replaykit">ReplayKit</a>at WWDC15 along with iOS 9. ReplayKit is an incredible API which makes it extremely simple for developers to integrate safe and efficient screen recording into their apps. This way, with a tap of a button, players can record their game and instantly share it with their friends. Now before you say it, I know that iOS 11 introduced a way to record your screen anywhere, but that feature is not as intuitive for gamers as it requires control center to be opened, and also requires that the user leaves the game to edit and send the video. ReplayKit is made specifically for gamers.</p>
<p>Today, I am going to show you how to make a simple screen recording app. The app will feature a recording start/stop button, a label that shows the status of the recording, and some UI elements to play with so you can record yourself doing something. Lets get started!</p>
<p>Note:I will be creating this tutorial with Swift 3 in Xcode 8 as there have been many problems reported with ReplayKit in iOS 11 beta. However, the ReplayKit code in this sample app is the same in Swift 3 as it is in Swift 4, so it should work the same if you are following along in Xcode 9. You will also need a physical device to run this app as screen recording does not work in the simulator.</p>
<h2 id="App-Overview"><a href="#App-Overview" class="headerlink" title="App Overview"></a>App Overview</h2><p>The app we will be making today is extremely simple to write and use. There is a green button which is used to start screen recording. Once tapped, the button will turn red and the status label at the top of the screen will indicate that it is currently recording. The app also features a segmented view with various color names in it. Tapping a color will change the background of the square in the middle of the screen to that color. This is here so you can record something changing on the screen. There is also a microphone toggle so you can choose if you want to record with the microphone or not.</p>
<p><img src="http://img1.tuicool.com/yayMBzE.png!web" alt=""></p>
<h2 id="Creating-the-Project"><a href="#Creating-the-Project" class="headerlink" title="Creating the Project"></a>Creating the Project</h2><p>Letâ€™s do this! Time to open Xcode and create a new project. Choose the_Single View Application_template for this app. I will be naming my project_ScreenRecord_but you can name it whatever you wish. Just be sure to set the language to Swift, and we donâ€™t need Core Data in this app, so leave that unchecked.</p>
<p><img src="http://img2.tuicool.com/JrI7Rfj.png!web" alt=""></p>
<p>Once you have created the project, go into the_Deployment Info_and uncheck the boxes next to<code>Landscape Left</code>and<code>Landscape Right</code>. No need for them in this project.</p>
<p><img src="http://img0.tuicool.com/Zreimi2.png!web" alt=""></p>
<h2 id="Creating-the-UI"><a href="#Creating-the-UI" class="headerlink" title="Creating the UI"></a>Creating the UI</h2><p>With this appâ€™s simple UI, this should not take long. Go ahead and open up the<code>Main.Storyboard</code>in the project navigator. Drag a<code>Label</code>to the top of the view and stretch it out a bit. I made mine 165 pixels wide. Make the label say<em>Ready to Record</em>(donâ€™t forget to do that, itâ€™s important). Add a<code>Segmented Control</code>a little under that. Make the segmented control have 4 segments and label each one a different color:<em>red</em>,<em>blue</em>,<em>orange</em>, and<em>green</em>. Make sure to stretch it out enough so the names are not cut off.</p>
<p><img src="http://img2.tuicool.com/7NRBVvz.png!web" alt=""></p>
<p>Next, add a<code>View</code>in the center of the view controller. Make it square (I made mine 150Ã—150) and change its background color to red. Add a<code>Switch</code>a little under the square. If you wish, you can put a label over the switch that says_Microphone_like I did. Lastly, add a<code>Button</code>under the switch. Make it square (mine is 65Ã—65), delete its title text, and change its background color to green.</p>
<p>Your view controller should now look like this:</p>
<p><img src="http://img0.tuicool.com/Zf6VBrA.png!web" alt=""></p>
<p>I will not be covering how to constrain these elements with Auto Layout in this tutorial. However, I highly suggest that you do. Check out ourAuto Layout Tutorial if you would like to learn how to use it. If you will not be using Auto Layout, be sure to set your storyboard size to the type of the device you will be running the app on.</p>
<h2 id="Outlets-Objects-and-View-Setup"><a href="#Outlets-Objects-and-View-Setup" class="headerlink" title="Outlets, Objects, and View Setup"></a>Outlets, Objects, and View Setup</h2><p>Now itâ€™s finally time to start coding! Head over to your<code>ViewController.swift</code>file in the project navigator and start by importing the ReplayKit framework above the class under where it says<code>import UIKit</code>.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import ReplayKit</div></pre></td></tr></table></figure>
<p>Now lets add the outlets so we can connect our code to the UI. We need five outlets in total:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">@IBOutlet var statusLabel: UILabel!</div><div class="line">@IBOutlet var colorPicker: UISegmentedControl!</div><div class="line">@IBOutlet var colorDisplay: UIView!</div><div class="line">@IBOutlet var recordButton: UIButton!</div><div class="line">@IBOutlet var micToggle: UISwitch!</div></pre></td></tr></table></figure>
<p>One outlet for each UI element. Your code should now look like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import UIKit</div><div class="line">import ReplayKit</div><div class="line"> </div><div class="line">class ViewController: UIViewController &#123;</div><div class="line">    </div><div class="line">    @IBOutlet var statusLabel: UILabel!</div><div class="line">    @IBOutlet var colorPicker: UISegmentedControl!</div><div class="line">    @IBOutlet var colorDisplay: UIView!</div><div class="line">    @IBOutlet var recordButton: UIButton!</div><div class="line">    @IBOutlet var micToggle: UISwitch!</div><div class="line"> </div><div class="line">    override func viewDidLoad() &#123;</div><div class="line">        super.viewDidLoad()</div><div class="line">        // Do any additional setup after loading the view, typically from a nib.</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    override func didReceiveMemoryWarning() &#123;</div><div class="line">        super.didReceiveMemoryWarning()</div><div class="line">        // Dispose of any resources that can be recreated.</div><div class="line">    &#125;</div><div class="line"> </div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now we need to create an object for our screen recorder. Declare the following variables under where we put the outlets.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">let recorder = RPScreenRecorder.shared()</div><div class="line">private var isRecording = false</div></pre></td></tr></table></figure>
<p>RPScreenRecorder is the shared recorder object providing the ability to record audio and video of your app. The<code>isRecording</code>variable is used to keep track of the recording status, whether it is doing a screen recording or not.</p>
<p>Next, letâ€™s make it so the start/stop button is rounded making it look more like a traditional record button. Add the following line into the<code>viewDidLoad()</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">recordButton.layer.cornerRadius = 32.5</div></pre></td></tr></table></figure>
<p>This make the button circular. If you made your record button the size that I did<em>(65Ã—65)</em>, this will make it a perfect circle since 32.5 is half of 65.</p>
<p>Now weâ€™re going to add a function called<code>viewReset()</code>. We will call this function when we finish a recording and want to reset all the elements in the view controller. Add the following after the<code>viewDidLoad()</code>, not inside it:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func viewReset() &#123;</div><div class="line">    micToggle.isEnabled = true</div><div class="line">    statusLabel.text = &quot;Ready to Record&quot;</div><div class="line">    statusLabel.textColor = UIColor.black</div><div class="line">    recordButton.backgroundColor = UIColor.green</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>What this does is turn the microphone switch on, set the<code>statusLabel</code>text to show that the app is ready, Changes the<code>statusLabel</code>text color to black, and changes the background color of<code>recordButton</code>back to green (it will be changed to red during recording).</p>
<p>Weâ€™re done with basic setup, your code should look like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">import UIKit</div><div class="line">import ReplayKit</div><div class="line"> </div><div class="line">class ViewController: UIViewController &#123;</div><div class="line">    </div><div class="line">    @IBOutlet var statusLabel: UILabel!</div><div class="line">    @IBOutlet var colorPicker: UISegmentedControl!</div><div class="line">    @IBOutlet var colorDisplay: UIView!</div><div class="line">    @IBOutlet var recordButton: UIButton!</div><div class="line">    @IBOutlet var micToggle: UISwitch!</div><div class="line">    </div><div class="line">    let recorder = RPScreenRecorder.shared()</div><div class="line">        private var isRecording = false</div><div class="line"> </div><div class="line">    override func viewDidLoad() &#123;</div><div class="line">        super.viewDidLoad()</div><div class="line">        // Do any additional setup after loading the view, typically from a nib.</div><div class="line">        recordButton.layer.cornerRadius = 32.5</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    func viewReset() &#123;</div><div class="line">        micToggle.isEnabled = true</div><div class="line">        statusLabel.text = &quot;Ready to Record&quot;</div><div class="line">        statusLabel.textColor = UIColor.black</div><div class="line">        recordButton.backgroundColor = UIColor.green</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    override func didReceiveMemoryWarning() &#123;</div><div class="line">        super.didReceiveMemoryWarning()</div><div class="line">        // Dispose of any resources that can be recreated.</div><div class="line">    &#125;</div><div class="line"> </div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Adding-Actions"><a href="#Adding-Actions" class="headerlink" title="Adding Actions"></a>Adding Actions</h2><p>So we have something to record, we added a segmented control which will change the color of a<code>UIView</code>. We only need one simple<code>IBAction</code>function to make this work. Add the following under the<code>viewReset()</code>function:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">@IBAction func colors(sender: UISegmentedControl) &#123;</div><div class="line">    switch sender.selectedSegmentIndex &#123;</div><div class="line">    case 0:</div><div class="line">        colorDisplay.backgroundColor = UIColor.red</div><div class="line">    case 1:</div><div class="line">        colorDisplay.backgroundColor = UIColor.blue</div><div class="line">    case 2:</div><div class="line">        colorDisplay.backgroundColor = UIColor.orange</div><div class="line">    case 3:</div><div class="line">        colorDisplay.backgroundColor = UIColor.green</div><div class="line">    default:</div><div class="line">        colorDisplay.backgroundColor = UIColor.red</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Let me explain what this does. The action is triggered by a sender that will be a<code>UISegmentedControl</code>. We have added a switch which takes the selected segment of the segmented control and changes the square viewâ€™s background to the right color.</p>
<p>Now add the action that will be called when the record button is tapped. Add the following under the colors function:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">@IBAction func recordButtonTapped() &#123;</div><div class="line">    if !isRecording &#123;</div><div class="line">        startRecording()</div><div class="line">    &#125; else &#123;</div><div class="line">        stopRecording()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This is a very simple function for toggling the recording mode. If the status of<code>isRecording</code>is<code>false</code>, that means that weâ€™re not recording yet, so we call the<code>startRecording()</code>function. If the value is set to<code>true</code>, that means that the app is in recording mode, so it calls the<code>stopRecording()</code>function. Now, we have not created these two functions yet, so ignore the errors that come up for now.</p>
<h2 id="Connecting-UI-elements"><a href="#Connecting-UI-elements" class="headerlink" title="Connecting UI elements"></a>Connecting UI elements</h2><p>Now that we have finished adding all of the outlets and actions needed for this project, head back to the<code>Main.storyboard</code>so we can connect them to the proper UI elements. Click on the view controller and then click on the connections inspector (the little arrow in the utilities panel on the right). Now drag all of the outlets to their respective subviews.</p>
<p><img src="http://img0.tuicool.com/7VNJj2J.png!web" alt=""></p>
<p>Now itâ€™s time to connect the actions. Connect the<code>recordButtonTapped</code>action to the record button at the bottom of the view, then select<em>Touch Up Inside</em>. Now connect the<code>colorsWithSender</code>action to the segmented control. This time make sure you select_Value Changed_so the action is called each time a new segment is selected.</p>
<p><img src="http://img2.tuicool.com/r6jiAvj.png!web" alt=""></p>
<p>Now that all the actions and outlets are connected, itâ€™s time to head back into the<code>ViewController.swift</code>.</p>
<h2 id="Starting-a-Recording"><a href="#Starting-a-Recording" class="headerlink" title="Starting a Recording"></a>Starting a Recording</h2><p>Now it is finally time to get to the ReplayKit part of this tutorial! First weâ€™re going to be adding the<code>startRecording()</code>function. Add the following under the<code>recordButtonTapped</code>action:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func startRecording() &#123;</div><div class="line">    </div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Okay, so the first thing we need to do is ensure that the screen recorder is actually available for recording. Now there can be many reasons that it is not, such as the device being unsupported by ReplayKit, or the user streaming to a TV using AirPlay. To check if the recorder is available, we will add the following code to the<code>startRecording</code>function:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">guard recorder.isAvailable else &#123;</div><div class="line">    print(&quot;Recording is not available at this time.&quot;)</div><div class="line">    return</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Itâ€™s simple as that. This guard checks if the recorder is available. If itâ€™s not, an error will be printed and the function will be returned.<em>Make sure to put all other code in this function under this guard.</em></p>
<p>Remember that microphone switch we added to our view? Now itâ€™s time to check the value of that switch. Add the following code under the guard:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">if micToggle.isOn &#123;</div><div class="line">    recorder.isMicrophoneEnabled = true</div><div class="line"> </div><div class="line">&#125; else &#123;</div><div class="line">    recorder.isMicrophoneEnabled = false</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If the switch is on, we enable the microphone by setting<code>isMicrophoneEnabled</code>to true. If not, we disable it. Simple as that.</p>
<p>Now itâ€™s time to actually start the recording. Add the following code:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">//1</div><div class="line">recorder.startRecording&#123; [unowned self] (error) in</div><div class="line">    //2</div><div class="line">    guard error == nil else &#123;</div><div class="line">        print(&quot;There was an error starting the recording.&quot;)</div><div class="line">        return</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    //3</div><div class="line">    print(&quot;Started Recording Successfully&quot;)</div><div class="line">    self.micToggle.isEnabled = false</div><div class="line">    self.recordButton.backgroundColor = UIColor.red</div><div class="line">    self.statusLabel.text = &quot;Recording...&quot;</div><div class="line">    self.statusLabel.textColor = UIColor.red</div><div class="line">        </div><div class="line">        self.isRecording = true</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Letâ€™s go through what this does:</p>
<p>1: We call the<code>startRecording</code>function on the recorder. This function has a handler.</p>
<p>2: In the handler, we add a guard which makes sure there is no error. If there is an error, we print an error message and return the function.</p>
<p>3: The recording has successfully started. We print that it is working and change the UI elements to show the user that the app is recording. To do this, we disable the microphone switch, set the recording button background to red, set the status label to say_recording_and change its text color to red.</p>
<p>Weâ€™re now done with the<code>startRecording</code>function! The full function should look like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func startRecording() &#123;</div><div class="line">    </div><div class="line">    guard recorder.isAvailable else &#123;</div><div class="line">        print(&quot;Recording is not available at this time.&quot;)</div><div class="line">        return</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if micToggle.isOn &#123;</div><div class="line">        recorder.isMicrophoneEnabled = true</div><div class="line">    &#125; else &#123;</div><div class="line">        recorder.isMicrophoneEnabled = false</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    recorder.startRecording&#123; [unowned self] (error) in</div><div class="line">        </div><div class="line">        guard error == nil else &#123;</div><div class="line">            print(&quot;There was an error starting the recording.&quot;)</div><div class="line">            return</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        print(&quot;Started Recording Successfully&quot;)</div><div class="line">        self.micToggle.isEnabled = false</div><div class="line">        self.recordButton.backgroundColor = UIColor.red</div><div class="line">        self.statusLabel.text = &quot;Recording...&quot;</div><div class="line">        self.statusLabel.textColor = UIColor.red</div><div class="line">                </div><div class="line">                self.isRecording = true</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Stopping-Editing-and-Saving"><a href="#Stopping-Editing-and-Saving" class="headerlink" title="Stopping, Editing, and Saving"></a>Stopping, Editing, and Saving</h2><p>Now that we have started a recording, we need to stop it! Time to make the<code>stopRecording()</code>function. Add the following under the<code>startRecording()</code>function:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func stopRecording() &#123;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now we need to call the<code>stopRecording()</code>function on the recorder. Add the following to the<code>stopRecording()</code>function:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">recorder.stopRecording &#123; [unowned self] (preview, error) in</div><div class="line">   print(&quot;Stopped recording&quot;)</div><div class="line"> </div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Here we call the<code>stopRecording</code>function which of course stops the recording, but there is a little more to itâ€¦</p>
<p>Wouldnâ€™t it be great if we can add a cool edit view where the user can preview their recording, trim it, and then send it to their friends all without leaving our app? Well lucky for us, Apple gave us the<code>RPPreviewViewController</code>which does just this and all we need to do is call it!</p>
<p>The<code>stopRecording</code>function creates a preview controller which we can call in the handler.</p>
<p>First we want to make sure that the preview controller is available. Add this guard after the print statement that says the recording was stopped:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">guard preview != nil else &#123;</div><div class="line">    print(&quot;Preview controller is not available.&quot;)</div><div class="line">    return</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If the preview is not available, the function will be returned instead of the app crashing!</p>
<p>Next, we want to add an alert view. Say the gamer played a bad round and doesnâ€™t want to share the recording with their friends. Well instead of going into the preview controller, watching their bad game moment, and then canceling, they can just delete the recording right after they stop it.</p>
<p>Add the following after the guard:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">let alert = UIAlertController(title: &quot;Recording Finished&quot;, message: &quot;Would you like to edit or delete your recording?&quot;, preferredStyle: .alert)</div><div class="line"> </div><div class="line">let deleteAction = UIAlertAction(title: &quot;Delete&quot;, style: .destructive, handler: &#123; (action: UIAlertAction) in</div><div class="line">    self.recorder.discardRecording(handler: &#123; () -&gt; Void in</div><div class="line">        print(&quot;Recording suffessfully deleted.&quot;)</div><div class="line">    &#125;)</div><div class="line">&#125;)</div><div class="line"> </div><div class="line">let editAction = UIAlertAction(title: &quot;Edit&quot;, style: .default, handler: &#123; (action: UIAlertAction) -&gt; Void in</div><div class="line">    preview?.previewControllerDelegate = self</div><div class="line">    self.present(preview!, animated: true, completion: nil)</div><div class="line">&#125;)</div><div class="line"> </div><div class="line">alert.addAction(editAction)</div><div class="line">alert.addAction(deleteAction)</div><div class="line">self.present(alert, animated: true, completion: nil)</div><div class="line"> </div><div class="line">self.isRecording = false</div><div class="line">self.viewReset()</div></pre></td></tr></table></figure>
<p>Now after you add this, go back up to the class declaration way at the top of the ViewController. You need to add the preview controller delegate. Next to where it says<code>UIViewController</code>add a comma (<code>,</code>) and type<code>RPPreviewViewControllerDelegate</code>.</p>
<p>So what are we doing here?</p>
<p>1: We create an alert controller with the appropriate title, message, and style.</p>
<p>2: We create a destructive delete action which if called, will discard the recording to the gamer never has to relive their failed game. (Weâ€™re doing people some real favors here!)</p>
<p>3: We create an edit action. If tapped, this action will open up the preview controller so the gamer can watch their recording, save it to their phone, edit it, or do whatever they want with it.</p>
<p>4: We add the actions to the alert and present it.</p>
<p>5: We call the<code>viewReset()</code>function so the view is just like new when the alert is dismissed.</p>
<p>The<code>stopRecording()</code>function is done! The whole function should look like this:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func stopRecording() &#123;</div><div class="line">        </div><div class="line">        recorder.stopRecording &#123; [unowned self] (preview, error) in</div><div class="line">            print(&quot;Stopped recording&quot;)</div><div class="line">            </div><div class="line">            guard preview != nil else &#123;</div><div class="line">                print(&quot;Preview controller is not available.&quot;)</div><div class="line">                return</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            let alert = UIAlertController(title: &quot;Recording Finished&quot;, message: &quot;Would you like to edit or delete your recording?&quot;, preferredStyle: .alert)</div><div class="line">                </div><div class="line">            let deleteAction = UIAlertAction(title: &quot;Delete&quot;, style: .destructive, handler: &#123; (action: UIAlertAction) in</div><div class="line">                self.recorder.discardRecording(handler: &#123; () -&gt; Void in</div><div class="line">                    print(&quot;Recording suffessfully deleted.&quot;)</div><div class="line">                &#125;)</div><div class="line">            &#125;)</div><div class="line">                </div><div class="line">            let editAction = UIAlertAction(title: &quot;Edit&quot;, style: .default, handler: &#123; (action: UIAlertAction) -&gt; Void in</div><div class="line">                preview?.previewControllerDelegate = self</div><div class="line">                self.present(preview!, animated: true, completion: nil)</div><div class="line">            &#125;)</div><div class="line">                </div><div class="line">            alert.addAction(editAction)</div><div class="line">            alert.addAction(deleteAction)</div><div class="line">            self.present(alert, animated: true, completion: nil)</div><div class="line">                </div><div class="line">                        self.isRecording = false</div><div class="line">            self.viewReset()</div><div class="line">                </div><div class="line">        &#125;</div><div class="line">            </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>We are almost done with the project! There is just one more function we need to add. Type the following function after the<code>stopRecording()</code>function:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func previewControllerDidFinish(_ previewController: RPPreviewViewController) &#123;</div><div class="line">    dismiss(animated: true)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This short delegate function dismisses the preview controller when the user taps the_cancel_button.</p>
<h2 id="Try-it-Out"><a href="#Try-it-Out" class="headerlink" title="Try it Out!"></a>Try it Out!</h2><p>Now itâ€™s time to put your hard work to the test. Run the app on your phone and tap the green record button. You will notice that an alert comes up asking for your permission to record the screen or record the screen with the microphone. This is an awesome thing about ReplayKit because Apple automatically has the app ask for permission. This way we donâ€™t have to program it ourselves like we do with coreLocation and notifications.</p>
<p><img src="http://img2.tuicool.com/jiUVZj3.png!web" alt=""></p>
<p>Tap<em>Record Screen &amp; Microphone</em>. The status label should say_recordingâ€¦_and turn red, as should the record button. You are now recording your screen! Play with the segmented control to change the colors of the square. If you left the microphone toggle on, say some stuff, maybe sing a song, whatever you want ï¿½ï¿½</p>
<p>When youâ€™ve had your fun, tap the record button again to stop the recording, you should now see the alert view asking what you want to do with your recording. If you sang a song and you donâ€™t think youâ€™re a great singer, maybe delete your recording and take another one. However, if you want to show off your awesome color changing square and singing voice, hit the_edit_button.</p>
<p><img src="http://img1.tuicool.com/RbUV7rJ.png!web" alt=""></p>
<p>Now you can watch your recording, trim it, save it to your photo library, or share it with the world. If you donâ€™t think your friends will understand how amazing your new recording is, tap_Cancel_in the upper left to dismiss the view and delete your recording.</p>
<h2 id="Wrap-Up"><a href="#Wrap-Up" class="headerlink" title="Wrap Up"></a>Wrap Up</h2><p>Congratulations! You just made an epic screen recording app that will keep you entertained for hoursâ€¦ Well I guess not, but even though this app does not do much, it has taught you everything you need to know to add awesome screen recording into your game with ReplayKit. Go and add screen recording into your games and leave a comment telling me so I can check it out!</p>
<p>Wanna do more with ReplayKit? Stay tuned with my next tutorial on how to add live broadcasting. How can a game not be awesome if it has live broadcasting?!</p>
<p>If anything in this tutorial confused you or you have some suggestions, feel free to leave a comment below and I can help you out!</p>
<p>For reference, the complete demo app that I created while making this tutorial is<a href="https://github.com/appcoda/ReplayKitDemo">available on GitHub</a>.</p>
<p>For more details about the ReplayKit framework, you can refer to the<a href="https://developer.apple.com/documentation/replaykit">documentation</a>.</p>
<p>What do you think of ReplayKit? Did you ever think that it can be so easy to add screen recording into your app? Leave a comment and let me know.</p>
<p>Source: <a href="http://www.tuicool.com/articles/hit/FNNfeiq">http://www.appcoda.com/replaykit/</a></p>

  </div>
  

 <!-- jsSocials -->
<script src="/jssocials-1.4.0/jssocials.min.js"></script>
<link rel="stylesheet" href="/jssocials-1.4.0/jssocials.css">
<link rel="stylesheet" href="/jssocials-1.4.0/jssocials-theme-flat.css">

<div class="socials-share-btn"></div>
<script>
  if ($) {
    $(document).ready(function(){
      $(".socials-share-btn").jsSocials({
        shares: ["email", "twitter", "facebook", "googleplus", "linkedin", "pinterest", "stumbleupon", "whatsapp"]
      });
    })
  }
</script>


  
<section id="comments">
  <div id="disqus_thread"></div>
</section>
<script>
  var disqus_shortname = 'gmagon';
  var disqus_url = 'https://gmagon.com/blog/2017/08/25/a-simple-screen-recording-app-replaykit/index.html';
  var disqus_title = "A Simple Screen Recording App-ReplayKit";
  var disqus_config = function(){
    this.language = 'en';
  };
  (function(){
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

  <script src="/js/audios.js"></script>
</article>

          </div>
      
          <aside id="article-toc" role="navigation">
                <div id="article-toc-inner">
                  <strong class="sidebar-title">Contents</strong>
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#App-Overview"><span class="toc-text">App Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating-the-Project"><span class="toc-text">Creating the Project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating-the-UI"><span class="toc-text">Creating the UI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Outlets-Objects-and-View-Setup"><span class="toc-text">Outlets, Objects, and View Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adding-Actions"><span class="toc-text">Adding Actions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Connecting-UI-elements"><span class="toc-text">Connecting UI elements</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Starting-a-Recording"><span class="toc-text">Starting a Recording</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stopping-Editing-and-Saving"><span class="toc-text">Stopping, Editing, and Saving</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Try-it-Out"><span class="toc-text">Try it Out!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wrap-Up"><span class="toc-text">Wrap Up</span></a></li></ol>
                  <a href="#" id="article-toc-top">Back to Top</a>
                </div>
          </aside>
        </div>
      </article>
    </div>
  </div>
</div>

<div class="class-content-wrap">
  <div class="inner">
    <div class="inner-wrap landing-bunting">
      <div class="intro-sub-content-wrap">
      </div>
    </div>
  </div>
</div>



    <footer id="footer" class="landing-bunting font-e3">
  <div class="inner">
    <div id="footer-some-docs">
        <a href="/terms_conditions.html" class="footer-doc-link" >Terms & Conditions</a>
        <a href="/privacy.html" class="footer-doc-link" >Privacy</a>
        <a href="/end-user-license-agreement.html" class="footer-doc-link" >License Agreement</a>
    </div>
    <div id="footer-copyright">
       <a href="" > Copyright &copy; 2017 Gmagon,Inc. All rights reserved. </a>
    </div>
  </div>

  <div class="inner">
    <div id="footer-links">
        
        <a href="https://twitter.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-twitter"></i></a>
        
        <a href="https://www.facebook.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-facebook"></i></a>
        <a href="https://www.youtube.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-youtube"></i></a>
        <a href="https://www.instagram.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-instagram"></i></a>
    </div>
  </div>


  <div class="inner">
    <div id="footer-security">
       <p>
          <img src="/asset/images/security/klogo.png">
          <img src="/asset/images/security/mcafee.png">
          <img src="/asset/images/security/cmmodo_scanned.png">
          <img src="/asset/images/security/softonic_tested.png">
          <img src="/asset/images/security/tested_by_sucuri.png">
          <img src="/asset/images/security/norton.png">
          <img src="/asset/images/security/eset_logo.png">
       </p>
    </div>
  </div>




</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/" class="mobile-nav-link ">Home</a><a href="/products/" class="mobile-nav-link ">Products</a><a href="/guide/" class="mobile-nav-link ">Guide</a><a href="/support/" class="mobile-nav-link ">Support</a><a href="/blog/" class="mobile-nav-link ">Blog</a>
      
    </ul>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>

  <!-- Scripts -->
<script src="/build/js/main-8277743eaa.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/retinajs/1.3.0/retina.min.js" async></script> -->

<!-- totop -->
<div id="gmagon_totop" style="position:fixed;bottom:150px;right:30px;cursor: pointer;">
  <a title="Back to top"><img src="/asset/images/scroll-up.png"/></a>
</div>
<script src="/js/totop.js"></script>





<!-- Google Analytics -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99314951-1', 'auto');
  ga('send', 'pageview');
</script>


</body>
</html>